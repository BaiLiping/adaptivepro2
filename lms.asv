function [w,k] = lms(s,x,mu,order)
N = length(s);
w = zeros(order, N);
r = zeros(1,N);
mu1 = 10;
k=0;
for n = order:N
    s_n = s(n:-1:n-order+1);
      r(n) = x(n)- transpose(s_n)*w(:,n-1);
      if r(n)>0.10
        w(:,n) = w(:,n-1) + mu1*s_n*(r(n)); 
        k=k+1;
      else
        w(:,n) = w(:,n-1) + mu*s_n*(r(n));  
      end

end
end


